pipeline 
{
    agent any
    stages 
    {
        stage('checkout') 
        {
            steps 
            {
                git branch: 'deploy-on-nginx', url: "https://github.com/bharathcegit/sample-html-app.git"
            }
        }
        stage('installation') 
        {
            steps 
            {
                sh 'ansible-vault decrypt --vault-id /tmp/vault-id newkey.pem'
                sh 'chmod 400 newkey.pem'
                sh "ansible-playbook -i inventory ansible-installation.yml"
            }
        }
        stage('deploy') 
        {
            steps 
            {
                sh 'ansible-vault decrypt --vault-id /tmp/vault-id new_key.pem'
                sh 'chmod 400 new_key.pem'
                sh "ansible-playbook -i inventory deploy-on-nginx.yml"
            }
        }
    }
}